apiVersion: apps/v1
kind: Deployment
metadata:
  name: kafka-producer
  labels:
    app: kafka-producer
spec:
  replicas: 1
  selector:
    matchLabels:
      app: kafka-producer
  template:
    metadata:
      labels:
        app: kafka-producer
    spec:
      containers:
      - name: kafka-producer
        image: giangtrinh2911/kafka-producer:latest
        env:
        # Pass Kafka configuration and CSV file path through environment variables
        - name: KAFKA_BOOTSTRAP_SERVERS
          value: "kafka:29092"  # Matches your Kubernetes Kafka service
        - name: KAFKA_TOPIC_TEST
          value: "test"
        - name: KAFKA_API_VERSION
          value: "7.3.1"
        - name: CSV_FILE
          value: "ecommerce_1000_Oct_2019.csv"
      #   volumeMounts:
      #   # Mount the ConfigMap containing the CSV file
      #   - name: csv-data
      #     mountPath: /data
      #     readOnly: true
      # volumes:
      # - name: csv-data
      #   configMap:
      #     name: csv-configmap
# ---
# apiVersion: v1
# kind: ConfigMap
# metadata:
#   name: csv-configmap
# data:
#   # Embed your CSV file content here
#   ecommerce_1000_Oct_2019.csv: |
#     ,event_time,event_type,product_id,category_id,category_code,brand,price,user_id,user_session
#     0,2019-11-01 00:00:00 UTC,view,1003461,2053013555631882655,electronics.smartphone,xiaomi,489.07,520088904,4d3b30da-a5e4-49df-b1a8-ba5943f1dd33
#     1,2019-11-01 00:00:00 UTC,view,5000088,2053013566100866035,appliances.sewing_machine,janome,293.65,530496790,8e5f4f83-366c-4f70-860e-ca7417414283
#     2,2019-11-01 00:00:01 UTC,view,17302664,2053013553853497655,,creed,28.31,561587266,755422e7-9040-477b-9bd2-6a6e8fd97387
#     3,2019-11-01 00:00:01 UTC,view,3601530,2053013563810775923,appliances.kitchen.washer,lg,712.87,518085591,3bfb58cd-7892-48cc-8020-2f17e6de6e7f
#     4,2019-11-01 00:00:01 UTC,view,1004775,2053013555631882655,electronics.smartphone,xiaomi,183.27,558856683,313628f1-68b8-460d-84f6-cec7a8796ef2
#     5,2019-11-01 00:00:01 UTC,view,1306894,2053013558920217191,computers.notebook,hp,360.09,520772685,816a59f3-f5ae-4ccd-9b23-82aa8c23d33c
#     6,2019-11-01 00:00:01 UTC,view,1306421,2053013558920217191,computers.notebook,hp,514.56,514028527,df8184cc-3694-4549-8c8c-6b5171877376
#     7,2019-11-01 00:00:02 UTC,view,15900065,2053013558190408249,,rondell,30.86,518574284,5e6ef132-4d7c-4730-8c7f-85aa4082588f
#     8,2019-11-01 00:00:02 UTC,view,12708937,2053013553559896355,,michelin,72.72,532364121,0a899268-31eb-46de-898d-09b2da950b24
#     9,2019-11-01 00:00:02 UTC,view,1004258,2053013555631882655,electronics.smartphone,apple,732.07,532647354,d2d3d2c6-631d-489e-9fb5-06f340b85be0
#     10,2019-11-01 00:00:03 UTC,view,17200570,2053013559792632471,furniture.living_room.sofa,,437.33,518780843,aa806835-b14c-45af-9538-cd4d1849be3e
#     11,2019-11-01 00:00:03 UTC,view,2701517,2053013563911439225,appliances.kitchen.refrigerators,,155.11,518427361,c89b0d96-247f-4044-9c91-bb5f38c6af9b
    # 12,2019-11-01 00:00:03 UTC,view,16700260,2053013559901684381,furniture.kitchen.chair,,31.64,566255262,173d7b72-1db7-4638-8207-be8148bf3c9f
    # 13,2019-11-01 00:00:04 UTC,view,34600011,2060981320581906480,,,20.54,512416379,4dfe2c67-e537-4dc2-ae69-0b65263db091
    # 14,2019-11-01 00:00:05 UTC,view,4600658,2053013563944993659,appliances.kitchen.dishwasher,samsung,411.83,526595547,aab33a9a-29c3-4d50-84c1-8a2bc9256104
    # 15,2019-11-01 00:00:06 UTC,view,24900193,2053013562183385881,,,1.09,512651494,f603c815-f51a-46fe-9404-cb586e35edaf
    # 16,2019-11-01 00:00:07 UTC,view,27400066,2053013563391345499,,,8.55,551061950,3f6112f1-5695-4e88-bb0a-49f9e36658ff
    # 17,2019-11-01 00:00:07 UTC,view,5100503,2053013553375346967,,xiaomi,22.68,520037415,f54fa96a-f3f2-43ac-99a4-fcb2a449dd36
    # 18,2019-11-01 00:00:07 UTC,view,1004566,2053013555631882655,electronics.smartphone,huawei,164.84,566265908,52c2c76c-b79e-4794-86ff-badc76d35f5a
